# Flow QA — 게임 플로우가 의도대로 흐르는가

게임의 전체 흐름(씬 전환, 상태 진행, 이벤트 체인)이 끊기지 않고, 플레이어가 예상치 못한 곳에 갇히지 않는지를 판단한다.

---

## 우려 유형

이 도메인에서 발생할 수 있는 구조적 우려. 게임 프로필을 보고 **해당하는 항목만** 시나리오로 구체화한다.

### 1. 막다른 길 (Dead End)
- **관점:** 플레이어가 어떤 상태/씬에 도달한 뒤 다음으로 진행할 수 없는 경우가 있는가?
- **살펴볼 곳:** 씬 전환 그래프에서 출구가 없는 노드, 상태 머신에서 탈출 조건이 없는 상태
- **판단 기준:** 의도적 종료(게임 오버, 엔딩)가 아닌데 다음 전환이 정의되지 않은 경우

### 2. 도달 불가 (Unreachable)
- **관점:** 만들어 놓았지만 플레이어가 절대 도달할 수 없는 경로가 있는가?
- **살펴볼 곳:** 씬 전환 그래프에서 진입 경로가 없는 노드, 상태 enum 중 전환 대상으로 지정되지 않은 값
- **판단 기준:** 코드에 정의되어 있으나 어디에서도 전환 대상으로 사용되지 않는 경우

### 3. 의도치 않은 순환 (Unintended Loop)
- **관점:** 플레이어가 빠져나올 수 없는 반복에 갇힐 수 있는가?
- **살펴볼 곳:** 상태 A→B→A 순환이 있을 때 탈출 조건이 명확한지
- **판단 기준:** 게임 루프(턴 반복 등)는 의도된 순환. 문제는 탈출 조건이 불분명하거나 도달 불가능한 순환

### 4. 초기화 순서 의존 (Init Order Dependency)
- **관점:** 시스템 초기화 순서가 바뀌면 게임이 깨지는가?
- **살펴볼 곳:** Awake/Start에서 다른 시스템의 상태에 의존하는 코드. DontDestroyOnLoad 오브젝트의 초기화 타이밍
- **판단 기준:** Script Execution Order나 명시적 순서 보장 없이 "먼저 초기화될 것"을 가정하는 경우

### 5. 씬 전환 시 데이터 유실 (Data Loss on Transition)
- **관점:** 씬이 바뀔 때 보존해야 할 데이터가 사라지는가?
- **살펴볼 곳:** DontDestroyOnLoad이 자식 오브젝트에만 적용된 경우. 씬 간 데이터 전달 방식(PlayerPrefs, static, SO)
- **판단 기준:** 씬 전환 전후로 데이터 일관성이 보장되지 않는 경우

### 6. 이벤트 체인 단절 (Broken Event Chain)
- **관점:** A가 B에게 알려야 하는데, 이벤트가 전달되지 않는 경우가 있는가?
- **살펴볼 곳:** 이벤트 발행/구독 관계에서 구독 타이밍 문제, 구독 해지 후 재발행
- **판단 기준:** 이벤트 발행 시점에 구독자가 아직 등록되지 않았거나 이미 해지된 경우

---

## 코드 검증 관점

우려가 도출되면 다음 관점에서 코드를 추적한다:

- 씬 전환 호출부의 **조건 분기**를 추적하여 실제 실행 경로 파악
- 상태 전환의 **전제 조건**이 항상 충족 가능한지 확인
- 초기화 코드의 **실행 순서**가 보장되는지 확인 (Execution Order, 명시적 호출 등)
- 이벤트의 **생명주기** 추적: 구독 시점, 해지 시점, 발행 시점

---

## 런타임 검증 관점

- 실제 씬 전환을 수행하고 `get_state`로 도달 확인
- 상태 전환 후 게임 데이터 값을 `execute_code`로 조회하여 유실 여부 확인
- DontDestroyOnLoad 오브젝트가 씬 전환 후에도 존재하는지 확인
