# 세부 설계 수준 레이어 가이드

특정 기능, 서브시스템, 디자인 패턴, 모듈 내부 설계에 적용한다.

## Layer 1: 설계 방향

"왜 이 접근법인가"에 집중한다.

### 초안 포함 항목

- **목적**: 이 설계가 해결하는 문제 또는 달성하려는 것
- **설계 의도**: 핵심적으로 지키고자 하는 원칙 (예: 유연성, 단순성, 확장 용이성, 일관성)
- **접근법 후보**: 고려한 접근법/방법론 2~3개와 각각의 장단점
- **선택한 접근법**: 최종 선택과 그 이유

### 핵심 질문

> **[핵심]** "제시된 접근법 후보 중 선호하는 방향이 있습니까? 또는 다른 접근법이 있습니까?"
> **[핵심]** "이 설계에서 가장 중요한 품질은 무엇입니까? (예: 성능, 유지보수성, 확장성, 테스트 용이성)"

도메인 가이드가 로드되어 있으면 도메인별 스코프 가이드(`domains/도메인/references/detail-scope.md`)의 추가 질문을 함께 제시한다.

---

## Layer 2: 구조 설계

"어떤 구조로 만드는가". Layer 1에서 확정된 접근법의 핵심 구성 영역을 **하나씩** 진행한다.

### 초안 포함 항목

- **핵심 구성요소**: 구성요소와 각각의 책임
- **상호작용 흐름**: 구성요소 간 연결과 데이터 흐름
- **인터페이스 정의**: 구성요소 간 연결 방식과 규약
- **패턴 적용 방식**: 선택한 접근법이 구조에 어떻게 반영되는지
- **확장 포인트**: 향후 변경/확장이 예상되는 지점과 그 대응 설계

### 핵심 질문

> **[핵심]** "구성요소 간 책임 분리가 적절합니까? 경계를 다르게 나누고 싶은 부분이 있습니까?"
> "상호작용 흐름에서 우려되는 부분이 있습니까? (순환 의존, 성능 병목 등)"

도메인 가이드가 로드되어 있으면 도메인별 스코프 가이드(`domains/도메인/references/detail-scope.md`)의 추가 질문을 함께 제시한다.

---

## Layer 3: 실행 명세

"구체적으로 어떻게 실행하는가". Layer 2의 확정된 구성요소 중 **하나씩** 순서대로 진행한다.

### 초안 포함 항목

- **실행 항목 설계**: 각 항목의 입력/출력/규격
- **데이터/자료 구조**: 다루는 데이터의 형식과 조건
- **실행 패턴**: 구체적 실행 방식 (예: 처리 순서, 분기 로직, 위임 방식)
- **예외 처리**: 예상치 못한 상황과 대응 방식
- **사용 예시**: 이 구성요소를 활용하는 시나리오 (의도를 명확히 전달)
- **하위 계획 위임** (해당 시): 구성요소가 크고 복잡하지만 독립적인 경우, 실행 명세 대신 `[하위 계획 위임]` 마커와 인터페이스 정의만 작성 ([03_specification.md](../phases/03_specification.md) "하위 계획 위임" 절차 참조)
- 도메인 가이드가 로드되어 있으면 도메인별 스코프 가이드의 추가 초안 항목을 함께 포함한다.

### 핵심 질문

> **[핵심]** "실행 항목의 입력/출력과 규격이 명확하고 완전합니까? 빠진 항목이 있습니까?"
> "각 항목의 사전/사후 조건이 명확합니까?"

도메인 가이드가 로드되어 있으면 도메인별 스코프 가이드(`domains/도메인/references/detail-scope.md`)의 추가 질문을 함께 제시한다.

---

## 최종 계획서 구조

```
# [주제] — 점진적 설계서

## 개요
- 목적: [해결하는 문제]
- 강도: [사용된 질문 강도]
- 선택한 접근법: [접근법/방법론]

## 요구사항 및 설계 의도
Q&A 과정에서 파악한 핵심 의도와 요구사항을 정리한다.

- **핵심 의도**: [이 설계로 궁극적으로 달성하려는 것]
- **품질 우선순위**: [성능 > 확장성 등 사용자가 밝힌 우선순위]
- **명시적 제약**: [사용자가 밝힌 제약]
- **선호/비선호**: [사용자가 명시적으로 원하거나 원하지 않는 방향]

## 도메인별 분석 결과 (도메인 가이드 로드 시에만)
(도메인 가이드가 정의하는 분석 항목을 여기에 포함한다)

## Layer 1: 설계 방향
[Phase 1 확정 내용 — 의도, 후보 비교, 최종 선택]

## Layer 2: 구조 설계
### [구성요소 영역 1]
[Phase 2 확정 내용 — 책임, 흐름, 인터페이스]
### [구성요소 영역 2]
[Phase 2 확정 내용]

## Layer 3: 실행 명세
### [구성요소 1]
[Phase 3 확정 내용 — 입출력, 데이터, 실행 패턴, 예시]
### [구성요소 2]
[Phase 3 확정 내용]

## 위임된 하위 계획
| 구성요소 | 책임 | 인터페이스 경계 |
|----------|------|----------------|
(위임된 항목이 없으면 이 섹션 생략)

## 열린 질문
- [아직 결정되지 않은 사항들]

## 설계 결정 기록
| 결정 | 선택 | 이유 | 대안 |
|------|------|------|------|
```
