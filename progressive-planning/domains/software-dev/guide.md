# 소프트웨어 개발 도메인 가이드

초기화 Step 3에서 도메인이 "소프트웨어 개발"로 판단되면 이 가이드를 로드한다.
이 가이드는 SKILL.md의 범용 절차에 **추가**로 적용되는 소프트웨어 전용 절차를 정의한다.

---

## 도메인 전용 스코프 가이드

스코프별로 추가 초안 항목, 추가 질문이 정의되어 있다. 해당 스코프 판단 시 함께 로드한다:

- **프로젝트 수준** → [references/project-scope.md](references/project-scope.md)
- **세부 설계 수준** → [references/detail-scope.md](references/detail-scope.md)

### 최종 계획서 추가 섹션

최종 계획서에 아래 섹션을 **추가**한다:

```
## 코드베이스 분석 결과

- **기술 스택**: [에이전트가 확인한 기술 스택]
- **관련 기존 코드**: [계획에 영향을 주는 기존 모듈/파일 목록]
- **발견된 패턴/컨벤션**: [에이전트가 발견한 코드 패턴, 반드시 따라야 할 컨벤션]
- **정합성 검증 결과**: [최종 정리에서 확인한 계획-코드 정합성]
```

---

## 에이전트 활용 (소프트웨어 전용)

### 적용 조건

- **코드베이스가 존재할 때만** 사용한다. 신규 프로젝트(코드 없음)에서는 사용하지 않는다.
- 사용자가 에이전트 활용을 원하지 않으면 건너뛴다 (초기화 Step 4에서 확인).

### 사용할 에이전트

| 에이전트 | subagent_type | 용도 |
|----------|---------------|------|
| 코드베이스 탐색 | progressive-planning:codebase-explorer | 구조, 패턴, 의존성 조사 |
| 아키텍처 분석 | progressive-planning:codebase-architect | 아키텍처 방향, 구현 전략 분석 |

### MCP 도구 활용

MCP 도구가 활성화되어 있으면 에이전트와 병행 활용한다:
- **Serena MCP**: 심볼 검색, 구조 개요, 패턴 검색 — 정밀한 코드 분석
- **LSP 플러그인**: 타입 정보, 진단, 참조 추적 — 인터페이스 정합성 검증

---

## 단계별 코드베이스 조사

### 초기화: 코드베이스 사전 조사

초기화 Step 4에서 "기존 자료 탐색"을 선택한 경우, 아래 절차를 따른다.

에이전트를 2~3개 병렬 launch한다:

- **codebase-explorer** (`progressive-planning:codebase-explorer`) — 프로젝트 구조 + 아키텍처 패턴 파악
- **codebase-explorer** (`progressive-planning:codebase-explorer`) — 관련 영역 탐색 (계획 주제가 특정 영역에 해당할 때만)
- **codebase-architect** (`progressive-planning:codebase-architect`) — 아키텍처 방향 분석 (복잡한 프로젝트일 때)

에이전트 결과를 **코드베이스 현황 요약**으로 정리하여 사용자에게 공유한다:

```
## 코드베이스 현황 요약
- 기술 스택: [...]
- 아키텍처: [...]
- 관련 기존 코드: [...]
- 발견된 컨벤션/패턴: [...]
- 계획 시 고려할 제약: [...]
```

사용자가 보완/수정할 내용이 있으면 반영한 뒤 방향 설정으로 진행.

### 방향 설정 / 구조 설계 / 세부 명세: 레이어별 코드베이스 조사

각 레이어의 초안(단계 A)을 작성하기 전에, 초안에 반영해야 할 코드 현실을 파악한다.
에이전트 활용의 적용 조건을 확인한 뒤, 조건을 충족하면 에이전트를 launch한다.

**레이어별 조사 초점:**

| 레이어 | 프로젝트 수준 | 세부 설계 수준 |
|--------|--------------|---------------|
| Layer 1 | 초기화의 코드베이스 현황 요약을 참조 (추가 탐색 불필요 시 건너뜀) | 해당 모듈의 기존 구현, 인접 모듈의 인터페이스, 사용 중인 패턴 |
| Layer 2 | 해당 단계에 관련된 기존 코드, 재사용 가능한 모듈, 기존 인터페이스 | 구성요소별 기존 코드, 의존하는 외부 API/라이브러리, 테스트 구조 |
| Layer 3 | 구현 대상 파일/클래스의 현재 상태, 관련 테스트, 유사 구현 참조 | 수정/생성 대상 코드의 현재 상태, 호출자/피호출자 관계, 기존 유틸리티 |

**에이전트 launch 패턴** (기본: `codebase-explorer`, 아키텍처 분석 필요 시 `codebase-architect` 병행):
- Layer 1: 일반적으로 초기화 결과로 충분. 부족하면 1개 추가 launch
- Layer 2: 해당 단계/영역별로 1~2개 launch
- Layer 3: 해당 구성요소별로 1개 launch

에이전트 결과를 초안(단계 A)에 반영한다: 기존 패턴과의 일관성, 재사용 가능한 코드, 인터페이스 호환성.

### 세부 명세: 하위 계획 위임 시 코드베이스 조사

하위 계획 위임이 확정되면, 경계 정의 전에 에이전트를 launch하여 인터페이스 정의의 정확성을 확보한다.

`codebase-explorer` 1~2개를 launch하여 기존 공개 API, 기존 구현, 인접 모듈의 인터페이스, 관련 타입을 조사한다. 결과를 바탕으로 인터페이스/경계를 **실제 코드에 근거하여** 작성한다.

### 최종 정리: 계획-코드 정합성 검증

최종 정리 Step 3(전체 계획 통합) 실행 시, 최종 계획서가 조립된 뒤 계획과 실제 코드베이스 간 정합성을 검증한다.

`codebase-explorer` 1~2개를 launch하여 계획서의 파일/클래스 존재 여부, 인터페이스 시그니처 일치, 의존성/패턴 실재 여부를 검증한다. 불일치 발견 시 사용자에게 보고하고 수정 후 최종 검토로 진행한다.
